[tox]
toxworkdir=/tmp/tox
skipsdist = True
envlist =
    dj-{31}-db-{pg,sqlite,maria}

[testenv]
passenv =
    DATABASE_URL=sqlite:///tmp/db.sqlite3

setenv =
    DJANGO_SETTINGS_MODULE = test.library_app.settings
    dj-31: DJANGO_VERSION=3.1

deps =
    poetry
    setuptools>34.0

commands =
    poetry config virtualenvs.create false
    poetry install
    pip install "django~={env:DJANGO_VERSION}.0"
    coverage run --append --source=. ./test/manage.py test
